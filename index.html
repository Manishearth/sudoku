<!DOCTYPE html>
<html>
<head>
    <title>Sudoku solving app</title>
    <link rel=stylesheet href="./style.css" />
    <meta charset="utf-8">
    <script type="text/javascript" src="./sudoku.js"></script>
    <script type="text/javascript" src="./ui.js"></script>
</head>
<body>
    
<div id=container>
<div id="sudoku-container"></div>
<div id="controls-container">
    <div class=modes>
        <div class="button dark button-main">Main</div>
        <div class="button button-center">Center</div>
        <div class="button button-corner">Corner</div>
        <div class="button button-color">Color</div>
    </div>
    <div class=keypad>
        
    </div>

    <div class="buttons-other">
        <div class="button button-undo">Undo</div>
        <div class="button button-redo">Redo</div>
        <div class="button button-help">Help</div>
        <div class="button button-export">Export</div>
    </div>
</div>
</div>
<script type="text/javascript">
    let init, board, storage, s;
    let params = new URLSearchParams(window.location.search);
    if (board = params.get("board")) {
        if (s = State.deserialize_str(atob(board))) {
            init = s;
        } else {
            alert("Invalid board string");
        }
    } else if (params.has("resume")) {
        if (storage = localStorage.lastState) {
            if (s = State.deserialize_str(storage)) {
                init = s;
            } else {
                alert("Invalid board string in local storage");
            }
        }
    }
    if (!init) {
        init = new State();
    }
    window.SudokuBoard = genTable(document.getElementById('sudoku-container'), init);
    genKeyPad(document.getElementsByClassName('keypad')[0]);
    window.SudokuButtons = new Buttons(document.getElementById('controls-container'), SudokuBoard);
    SudokuButtons.attachKeyboardEvent(document.body);
</script>

</body>
</html>